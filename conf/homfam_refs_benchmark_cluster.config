params{

    skip_stats       = false
    skip_eval        = false

    calc_sp                     = true
    calc_tc                     = true
    calc_irmsd                  = true
    calc_gaps                   = false
    calc_tcs                    = false

    calc_sim                    = false
    calc_seq_stats              = true
    extract_plddt               = true

    skip_multiqc                = false 

    max_memory                 = '500.GB'
    max_cpus                   = 64
    max_time                   = '240.h'


    outdir = "homfam_refs_benchmark_full"

    input = "assets/samplesheet_cluster.csv"
    tools = "assets/toolsheet.csv"

}

process {
    maxRetries = 5
}

def cluster_name = System.getenv("SLURM_CLUSTER_NAME")
 
if (cluster_name == "crg") {
    process {
        executor = 'slurm'
        queue    = 'genoa64'
        clusterOptions = {
            switch (task.time) {
                case { it > 168.h } :
                    return '--qos=ethernal'
                case (48<..168).h:
                    return '--qos=marathon'
                case (24<..48).h:
                    return '--qos=vlong'
                case (12<..24).h:
                    return '--qos=long'
                case (6<..12).h:
                    return '--qos=normal'
                case (3<..6).h:
                    return '--qos=short'
                case (1<..3).h:
                    return '--qos=shorter'
                default:
                    return '--qos=vshort'
            }
        }
    }
} else {
    process {
        executor = 'crg'
        beforeScript = 'module load Singularity/4.0.2'
        queue    = 'cn-el7,short-centos79,long-centos79'
        queue    = {
            switch (task.time) {
                case { it > 6.h } :
                    return 'cn-el7,long-centos79'
                case (3<..6).h:
                    return 'cn-el7,short-centos79'
                default:
                    return 'cn-el7'
            }
        }
    }
}
 
singularity {
    enabled = true
}

